<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Face Recognition (OpenCV.js) — Daftar & Presensi</title>




<link rel="stylesheet" href="presensi.css">
</head>
<body>
  <div class="card">

    <div class="header">
      <div style="display:flex;gap:12px;align-items:center">
        <div class="avatar"></div>
        <div>
          <div class="title">Face Recognition</div>
      <div class="subtle">OpenCV</div></div></div>
    </div>


    <!-- NAV -->
    <nav>
      <button id="tabEnroll" class="active">Daftarkan Wajah</button>
      <button id="tabAttend">Presensi Wajah</button>
    </nav>

    <!-- COMMON CAMERA CONTROLS -->
    <div class="grid">
      <div>
        <label>Pilih kamera</label>
        <select id="camera"></select>
        <div class="muted" style="font-size:12px">Jika kosong: klik Start lalu izinkan kamera.</div>
      </div>
      <div>
        <label>Ukuran canvas</label>
        <select id="size">
          <option value="320x240">320×240</option>
          <option value="480x360">480×360</option>
          <option value="640x480" selected>640×480</option>
        </select>
      </div>
      <div>
        <label>Process every N frames</label>
        <select id="nth">
          <option value="1">N=1</option>
          <option value="2" selected>N=2</option>
          <option value="3">N=3</option>
          <option value="4">N=4</option>
        </select>
      </div>
      <div class="row">
        <button id="start" disabled>Start</button>
        <button id="stop" class="secondary" disabled>Stop</button>
        <label style="display:flex;gap:6px;align-items:center;color:#9fb0c9">
          <input type="checkbox" id="showVideo"> preview video
        </label>
      </div>
    </div>

    <!-- SECTION: ENROLL -->
    <div id="sectionEnroll" class="section active">
      <div class="row" style="margin-top:10px">
        <div>
          <label>Nama untuk enroll</label>
          <input id="name" placeholder="mis: Sismadi">
        </div>
        <div>
          <label>Sample</label>
          <select id="samples"><option>10</option><option>15</option><option selected>20</option><option>30</option></select>
        </div>
        <div>
          <label>Threshold verifikasi (lihat mode presensi)</label>
          <input value="0.90" disabled>
        </div>
        <div class="row">
          <button id="enroll" class="secondary" disabled>Ambil Sampel</button>
          <button id="clearDb" class="secondary">Clear DB</button>
          <button id="exportDb" class="secondary">Export DB</button>
          <label class="secondary" style="padding:8px 12px;border-radius:10px;cursor:pointer;display:inline-flex;align-items:center;gap:6px;background:#334155">
            Import DB<input id="importDb" type="file" accept="application/json" style="display:none">
          </label>
        </div>
      </div>
      <p class="muted" style="margin-top:8px">Tips: ambil sampel di pencahayaan baik dan beberapa pose ringan (miring kiri/kanan).</p>
    </div>

    <!-- SECTION: ATTENDANCE -->
    <div id="sectionAttend" class="section">
      <div class="row" style="margin-top:10px">
        <div>
          <label>Threshold cosine (presensi)</label>
          <input id="th" value="0.90">
        </div>
        <div>
          <label>Cooldown per nama (detik)</label>
          <input id="cooldown" value="10">
        </div>
        <div class="row">
          <button id="exportAttend" class="secondary">Export Presensi (CSV)</button>
          <button id="clearAttend" class="secondary">Clear Presensi</button>
          <span class="muted" id="attCount" style="align-self:center;margin-left:8px"></span>
        </div>
      </div>

      <table id="attTable">
        <thead>
          <tr><th>#</th><th>Waktu</th><th>Nama</th><th>Score</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <p class="muted" id="status" style="margin-top:8px">Status: memuat OpenCV (WASM)…</p>
    <video id="video" playsinline autoplay muted></video>
    <canvas id="canvas" width="640" height="480"></canvas>
    <pre id="log" class="muted"></pre>
  </div>

  <!-- Load OpenCV.js synchronously -->
  <script src="https://docs.opencv.org/4.x/opencv.js"></script>
  <script src="presensi.js"></script>


</body>
</html>
